# Introduction
This is an alternative C++11 compiler for 
[Simple-Binary-Encoding](https://github.com/real-logic/simple-binary-encoding) schemas.
The generated protocol code uses [COMMS library](https://github.com/arobenko/comms_champion#comms-library)
from the [CommsChampion](https://github.com/arobenko/comms_champion)
project. The compiler also generates protocol plugin code for
[CommsChampion Tools](https://github.com/arobenko/comms_champion#commschampion-tools).
to allow visual analysis and debug of the protocol communication.

# Motivation
The [Simple-Binary-Encoding](https://github.com/real-logic/simple-binary-encoding)
reference compiler generates code in which every message object is simply
a **view** on a buffer of raw data. Such architecture makes encoding / decoding
operations very fast, which is a good thing. However, the generated code
requires writing a lot of additional boilerplate code in order
to integrate it into the project being developed. Such approach may be the right
direction to take when developing high frequency trading systems, where every 
microsecond matters. The protocol itself as well as  
[Simple-Binary-Encoding](https://github.com/real-logic/simple-binary-encoding)
reference compiler were developed specifically for this purpose. However,
there are lots of other use cases, such as IOT, SCADA and other embedded devices
where the encoding / decoding speeds are of lesser importance.

# Benefits
Below is a list of features available with this compiler, but not available
with reference one.

- Embedded (bare-metal) systems friendly, no exceptions are thrown to report an error.
- Highly configurable (at compile time) polymorphic interfaces to message classes, 
allows writing common code for all the messages.
- Meta-programming friendly, all the message and field classes expose the same
public interface, all the message fields are accessible by name and index. 
- Efficient (**O(1)** or **O(log(n)**) built-in mapping of numeric message ID to actual
message object.
- Efficient (**O(1)**) built-in polymorphic dispatch of the message object to
appropriate handling function.
- Ability to introduce additional compile time configurations and/or updates to
the generated code.
- Ability to access **all** message fields in any order, not just the root block.
- Alignment agnostic, no performance penalties for unaligned access to field values.
- Much safer against malformed data and/or buffer overflows.
- Built-in support for **Simple Open Framing Header** in addition to **Message Header**.

Even if the code generated by the reference compiler is good enough and fits
nicely into the project being developed, the **sbe2comms** compiler may still
be used to generate a plugin code for 
[CommsChampion Tools](https://github.com/arobenko/comms_champion#commschampion-tools),
to perform deeper protocol analysis and debugging.

# Generated Code
The **sbe2comms** compiler generates, not just protocol definition headers, it
generates a full CMake project. When built, the project may produce 

- Protocol definition headers
- Protocol library API documentation and tutorial
- Plugin for [CommsChampion Tools](https://github.com/arobenko/comms_champion#commschampion-tools)

Please open the root **CMakeLists.txt** file of the generated project to see
the available compilation options and variables.

**Note**, that the project documentation is not generated automatically, you
have to build **doc_<projname>** target separately.

# How to Build
This project uses **CMake** to generate native build systems.

The **sbe2comms** compiler also has two external dependencies:

- **libxml2** - for XML parsing
- **boost** - uses **program_options**, **filesystem** modules as well as 
string algorithms.

On **Linux** system just install the required packages and **cmake** will find
all the required libraries and headers.

It is also possible to provide custom builds of **boost** as well as **libxml2**.
To specify directories use the following variables in **cmake** invocation:

- **BOOST_ROOT** - Installation prefix of the **boost** libraries.
- **LIBXML2_INCLUDE_DIR** - Path to **include** directory installed by **libxml2** build.
- **LIBXML2_LIBRARIES** - Path to **lib** directory installed by **libxml2** build or
to the **libxml2** library itself.

Note, that on Windows platform with **Visual Studio** compiler the build of
**sbe2comms** compiler will check out and build internally **libxml2** library,
but only if external build of it is not provided (using **LIBXML2_INCLUDE_DIR** and
**LIBXML2_LIBRARIES** variables).

Also note, that there may be a linker error reporting of having symbols from
the **boost** libraries defined multiple types. It usually happens when custom
build of the libraries contains both static (**.lib**) and dynamic (**.dll**)
files available. In this case please please pass additional 
**-DBoost_USE_STATIC_LIBS=ON** option to cmake invocation.

The **sbe2comms** compiler itself as well as generated code is expected to get
compiled without problems with the following compilers:

- gcc v4.8 and above
- clang v3.9 and above
- VS2015

# How to Use
Invoke **sbe2comms** binary with **-h** option to receive a list of available
command line arguments.

# Examples
The [sbe2comms_example](https://github.com/arobenko/sbe2comms_example) project
hosts code generated by the **sbe2comms** compiler out of 
[example-extension-schema.xml](https://github.com/real-logic/simple-binary-encoding/blob/master/sbe-samples/src/main/resources/example-extension-schema.xml)
schema file from [simple-binary-encoding](https://github.com/real-logic/simple-binary-encoding)
project.

# Documentation
The [release artefacts](https://github.com/arobenko/sbe2comms/releases) 
contain **doc_example_X.zip** file. It is **doxygen** generated documentation from
the project, generated by the **sbe2comms** compiler out of 
[example-extension-schema.xml](https://github.com/real-logic/simple-binary-encoding/blob/master/sbe-samples/src/main/resources/example-extension-schema.xml)
schema file. It contains API documentation as well as full tutorial how
to use the generated protocol library.

# Licence 
The code of **sbe2comms** compiler is available under 
[GPLv3](https://www.gnu.org/licenses/gpl-3.0.en.html) license. The
generated code itself has no specific licence attached to it, and the developer is
free to choose one. However, the generated code
uses [COMMS library](https://github.com/arobenko/comms_champion#comms-library), which
uses **GPLv3** / **Commercial** classic dual licensing scheme. Unless, the 
commercial closed source license is obtained for the **COMMS** library, 
the generated code must also remain open source. See 
[here](https://github.com/arobenko/comms_champion/blob/master/LICENSE.md)
for more details.

# Branching Model
This repository will follow the 
[Successful Git Branching Model](http://nvie.com/posts/a-successful-git-branching-model/).

The **master** branch will always point to the latest release, the
development is performed on **develop** branch. As the result it is safe
to just clone the sources of this repository and use it without
any extra manipulations of looking for the latest stable version among the tags and
checking it out.

# Contact Information
For bug reports, feature requests, or any other question you may open an issue
here in **github** or e-mail me directly to: **arobenko@gmail.com**

